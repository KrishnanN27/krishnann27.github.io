<!-- Make sure this is in your <head> (usually in your base template) -->
<meta name="viewport" content="width=device-width, initial-scale=1" />

<header
  style="display:flex;justify-content:space-between;align-items:center;padding:0 1rem;"
>
  <div class="header-left" style="display:flex;align-items:center;gap:.5rem;min-width:0;flex:1 1 auto;">
    <!-- Brand -->
    <a href="{{ "" | relLangURL }}" class="brand"
      style="
        display:-webkit-box; -webkit-box-orient:vertical; -webkit-line-clamp:2;
        overflow:hidden; line-height:1.2; max-width:100%;
        font-size:clamp(1rem, 4.5vw, 1.1rem); font-weight:normal; text-decoration:none;
        word-break:break-word;
      ">
      Sowndarya Krishnan Navaneetha Kannan
    </a>

    {{ if .Site.Params.logo }}
    <a class="title" href="{{ "" | relLangURL }}" style="flex:0 0 auto;">
      {{ $imgData := dict "Page" . "URL" .Site.Params.logo "Alt" "Site Logo" "Size" "64x64" }}
      {{ partial "image-renderer.html" $imgData }}
    </a>
    {{ end }}
  </div>

  <div class="header-cntr" style="flex:0 0 auto;display:flex;justify-content:flex-end;align-items:center;gap:1rem;min-width:0;">
    <div class="menu" style="display:flex;align-items:center;gap:1rem;min-width:0;">
      <!-- Navigation -->
      <nav id="main-menu" class="mm-normal" aria-label="Primary">
        <ul style="display:flex;align-items:center;gap:1rem;margin:0;padding:0;list-style:none;">
          <li>
            <button id="mob-x-icon" class="menu-btn" aria-label="Close menu" type="button" style="display:none;">
              {{ partial "icon.html" "xmark" }}
            </button>
          </li>
          {{ range .Site.Menus.main }}
          <li>
            <a href="{{ .URL }}" aria-label="{{ .Name }}"
               style="text-decoration:none;display:flex;align-items:center;gap:.25rem;">
              {{ if .Pre }}<span>{{ partial "icon.html" .Pre }}</span>{{ end }}
              {{ .Title | emojify }}
            </a>
          </li>
          {{ end }}
        </ul>
      </nav>

      <!-- Search + Theme Switcher -->
      <div class="side-menu" style="display:flex;align-items:center;gap:.5rem;">
        {{ partial "search.html" . }}
        {{ if .Site.Params.showThemeSwitcher | default false }}
        <button id="theme-switcher" class="menu-btn" aria-label="Theme switcher" type="button"
                style="display:flex;align-items:center;gap:.25rem;">
          <div id="moon" style="font-size:1.3em;">{{ partial "icon.html" "moon" }}</div>
          <div id="sun" style="font-size:1.3em;">{{ partial "icon.html" "sun" }}</div>
        </button>
        {{ end }}
      </div>

      <!-- Hamburger -->
      <button id="mob-hb-icon" class="menu-btn" aria-label="Open menu" type="button"
              aria-expanded="false" aria-controls="main-menu">
        {{ partial "icon.html" "bars" }}
      </button>
    </div>
  </div>

  <!-- ✨ Updated Styles -->
  <style>
    header .menu-btn {
      background: none;
      border: 0;
      padding: .5rem;
      cursor: pointer;
      border-radius: .5rem;
      transition: background 0.2s;
    }
    header .menu-btn:hover { background: rgba(0,0,0,0.05); }
    header .brand { text-decoration:none }

    .header-left, .header-cntr, .menu { min-width: 0; }

    /* Desktop */
    @media (min-width:768px){
      #mob-hb-icon{display:none}
      #mob-x-icon{display:none !important}
      #main-menu.mm-normal{display:block}
      #main-menu ul{display:flex;align-items:center;gap:1rem;margin:0;padding:0;list-style:none}
      #main-menu a{text-decoration:none;display:flex;align-items:center;gap:.25rem}

      .brand{
        display:inline-block; -webkit-line-clamp:unset; -webkit-box-orient:unset;
        white-space:nowrap; text-overflow:ellipsis; overflow:hidden; max-width:100%;
      }
    }

    /* Mobile */
 /* Mobile */
@media (max-width:767.98px){
  header { padding: .75rem 1rem !important; }
  .header-left { gap: .4rem !important; }

  #main-menu.mm-normal{display:none}

  #main-menu.mm-mobile-open {
    position: fixed;
    inset: 0;
    display: flex;
    align-items: stretch;
    justify-content: flex-start;
    z-index: 9999;
    transition: background .3s ease;
    background: color-mix(in srgb, var(--secondary-color) 80%, transparent); /* light in light mode, dark in dark mode */
    backdrop-filter: blur(6px); /* frosted effect */
  }

  #main-menu.mm-mobile-open ul {
    display: flex;
    flex-direction: column;
    gap: 1.2rem;
    margin: 0;
    padding: 2rem 1.5rem;
    width: min(80vw, 320px);
    height: 100%;
    background: var(--secondary-color);
    color: var(--primary-color);
    box-shadow: 4px 0 12px rgba(0,0,0,.2);
    transform: translateX(-100%);
    animation: slideIn .3s forwards;
    border-radius: 0 .75rem .75rem 0;
  }

  #main-menu.mm-mobile-open a {
    font-size: 1.1rem;
    font-weight: 500;
    color: inherit;
    text-decoration: none;
    transition: color .2s;
  }
  #main-menu.mm-mobile-open a:hover { color: var(--link-color); }

  #mob-hb-icon { display: inline-flex }
  #mob-x-icon { display: none }
}


    /* Active highlight */
    #main-menu a.active{
      font-weight:600;
      text-decoration:underline;
      text-underline-offset:.2em;
    }

    /* Slide in animation */
    @keyframes slideIn { to{ transform:translateX(0); } }
  </style>

  <!-- ✨ Updated Script -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const hamburger = document.getElementById("mob-hb-icon");
      const closeBtn  = document.getElementById("mob-x-icon");
      const mobileMenu = document.getElementById("main-menu");
      const body = document.body;

      if (!hamburger || !closeBtn || !mobileMenu) return;

      function openMenu() {
        mobileMenu.classList.remove("mm-normal");
        mobileMenu.classList.add("mm-mobile-open");
        closeBtn.style.display = "inline-flex";
        hamburger.setAttribute("aria-expanded", "true");
        body.style.overflow = "hidden";
      }

      function closeMenu() {
        mobileMenu.classList.remove("mm-mobile-open");
        mobileMenu.classList.add("mm-normal");
        closeBtn.style.display = "none";
        hamburger.setAttribute("aria-expanded", "false");
        body.style.overflow = "";
      }

      hamburger.addEventListener("click", openMenu);
      closeBtn.addEventListener("click", closeMenu);

      // Close if tapping outside menu panel
      mobileMenu.addEventListener("click", (e) => {
        if (mobileMenu.classList.contains("mm-mobile-open") && e.target === mobileMenu) {
          closeMenu();
        }
      });

      // Close with ESC
      document.addEventListener("keydown", (e) => {
        if (e.key === "Escape" && mobileMenu.classList.contains("mm-mobile-open")) {
          closeMenu();
        }
      });
    });
  </script>
</header>
